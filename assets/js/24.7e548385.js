(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{527:function(s,a,t){"use strict";t.r(a);var e=t(6),n=Object(e.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[s._v("#")]),s._v(" 前言：")]),s._v(" "),t("p",[s._v("在mac os中，非root用户是无法使用小于1024的常用端口的。如果开发中需要用到80端口, 就要设置端口转发。")]),s._v(" "),t("h2",{attrs:{id:"hosts文件介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hosts文件介绍","aria-hidden":"true"}},[s._v("#")]),s._v(" hosts文件介绍")]),s._v(" "),t("ol",[t("li",[s._v("hosts文件是将域名和IP地址建立映射关系的系统文件，用户可以自定义常用域名跟IP，当在浏览器上输入网址时，系统会优先从hosts文件找到相应的IP地址，打开相应的网页。")]),s._v(" "),t("li",[s._v("hosts文件的作用是域名解析，构建映射关系，屏蔽垃圾网站。")]),s._v(" "),t("li",[s._v("为什么要修改hosts文件？\n在微信公众号开发时候，需要获取用户的微信信息，如果在微信开发者工具的地址栏填写localhost就获取不了，所以必须要填写审核通过的微信公众号域名。在这里，假设我的微信公众号域名为：https://test.cn 。本地启动了java项目，当你很高兴地在在微信开发者工具输入https://test.cn 时候，会注意到点击网页任意一个按钮，都不会触发到本地java项目的任何一个接口。原因好简单，因为默认hosts文件中，域名localhost 映射的是 127.0.0.1 ip地址。因此，需要把localhost 映射为https://test.cn。")])]),s._v(" "),t("h2",{attrs:{id:"修改hosts文件的步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改hosts文件的步骤","aria-hidden":"true"}},[s._v("#")]),s._v(" 修改hosts文件的步骤")]),s._v(" "),t("h3",{attrs:{id:"_1-打开terminal-输入以下指令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-打开terminal-输入以下指令","aria-hidden":"true"}},[s._v("#")]),s._v(" （1）打开Terminal，输入以下指令：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" /private/etc\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" hosts\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("打开后，默认的hosts文件长这样：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Host Database")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## localhost is used to configure the loopback interface")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## when the system is booting.  Do not change this entry.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n127.0.0.1                localhost\n255.255.255.255          broadcasthost\n::1                      localhost\n127.0.0.1                samuel.local "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## added by Apache Friends XAMPP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"_2-把localhost-映射为https-test-cn-改成你要映射的域名-后-修改后是张这样的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-把localhost-映射为https-test-cn-改成你要映射的域名-后-修改后是张这样的","aria-hidden":"true"}},[s._v("#")]),s._v(" （2）把localhost 映射为https://test.cn (改成你要映射的域名)后 ，修改后是张这样的：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("##\n## Host Database\n#\n## localhost is used to configure the loopback interface\n## when the system is booting.  Do not change this entry.\n##\n#127.0.0.1                 localhost\n  127.0.0.1                test.cn\n  255.255.255.255          broadcasthost\n  ::1                      localhost\n  127.0.0.1                samuel.local ## added by Apache Friends XAMPP\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("保存退出。")]),s._v(" "),t("h2",{attrs:{id:"端口转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#端口转发","aria-hidden":"true"}},[s._v("#")]),s._v(" 端口转发")]),s._v(" "),t("p",[s._v("域名映射完成后，需要做的是端口转发，也就是将监听的80端口转发到8080。")]),s._v(" "),t("h3",{attrs:{id:"_1-创建idea-tomcat-forwarding文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建idea-tomcat-forwarding文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.创建idea.tomcat.forwarding文件：")]),s._v(" "),t("p",[t("code",[s._v("sudo vim /etc/pf.anchors/idea.tomcat.forwarding")])]),s._v(" "),t("p",[s._v("在idea.tomcat.forwarding添加以下命令：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rdr pass on lo0 inet proto tcp from any to 127.0.0.1 port 80 -> 127.0.0.1 port 8080 \nrdr pass on lo0 inet proto tcp from any to 127.0.0.1 port 443 -> 127.0.0.1 port 8443 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_2-创建pf-tomcat-conf文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建pf-tomcat-conf文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.创建pf-tomcat.conf文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo vim /etc/pf-tomcat.conf \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在pf-tomcat.conf添加以下命令：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('rdr-anchor "forwarding"\nload anchor "forwarding" from "/etc/pf.anchors/idea.tomcat.forwarding"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_3-启动端口转发功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动端口转发功能","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.启动端口转发功能")]),s._v(" "),t("p",[t("code",[s._v("sudo pfctl -ef /etc/pf-tomcat.conf")])]),s._v(" "),t("p",[s._v("如果你在终端看到以下提示，恭喜你成功启动：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("pfctl: Use of -f option, could result in flushing of rules\npresent in the main ruleset added by the system at startup.\nSee /etc/pf.conf for further details.\n\nNo ALTQ support in kernel\nALTQ related functions disabled\npfctl: pf already enabled\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_4-关闭端口转发功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-关闭端口转发功能","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.关闭端口转发功能")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo pfctl -d \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("或者关闭全部")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("pfctl -F all -f /etc/pf.conf \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("注意事项：")]),s._v("\n重启mac，需要手动重启端口转发命令")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo pfctl -ef /etc/pf-tomcat.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("java项目配置\n在由spring boot搭建的java开发项目中，用到的开发工具是IDEA，操作系统mac OS 10.13.4。因为微信公众号的开发需要，端口号要设置为80，\n之前已经设置好端口转发，80转发到8080，所以在本地调试的时候，项目的服务器端口设置为8080，如下图：\n"),t("img",{attrs:{src:"http://img.kevinbobo.top/file/2019/01/b15653074fff4363b5f66599a679f204_image.png",alt:"imagepng"}})]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("原文：https://blog.csdn.net/samuelandkevin/article/details/80279773")])])},[],!1,null,null,null);a.default=n.exports}}]);